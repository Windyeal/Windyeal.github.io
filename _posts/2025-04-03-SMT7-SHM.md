---
layout:     post
title:      "HiDL中的Shmoo"
subtitle:   ""
date:       2025-04-03
author:     "Hisilcon"
header-style: text
catalog: true
published: true

tags:
    - HiCBB
    - SMT7
    
---
# Shmoo(SHM)

## 模式介绍

进行Shmoo扫描测试。

使用场景：可靠性测试，向量裕量测试。（SCAN,MBIST测试项）

## 参数说明

**Y**：填入纵轴扫描的spec的变量，默认为Tcoef。

**Y轴相关参数如下：**

**SpecType**：选择扫描方式RelativeMode或AbsoluteMode， 默认为RelativeMode。

**UL**：填入Y轴扫描的系数上限，默认为1.5。

**LL**：填入Y轴扫描的系数下限，默认为0.5。

**point**：填入Y轴扫描的点数。

**X**：填入纵轴扫描的spec的变量，默认为Vcoef。

**X轴相关参数如下：**

**SpecType**：选择扫描方式RelativeMode或AbsoluteMode， 默认为RelativeMode。

**UL**：填入X轴扫描的系数上限，默认为1.2。

**LL**：填入X轴扫描的系数下限，默认为0.8。

**point**：填入X轴扫描的点数。

**Vclamp_EN**：选择ON或OFF,默认为ON，使用Vclamp时选择为ON，否则选择OFF。

**ResultType**：填入当前测试项输出结果的形式，默认为All，可选All、PerLabelRow、PerLabel。

**Output**：选择log输出模式，默认为File+ReportUI，可选File、ReportUI、File+ReportUI、None。

**PowerMonitor**：选择ON或OFF，默认为OFF，使用PowerMonitor功能时选择ON，否则选择OFF。

**PreExecute**：选择ON或OFF，默认为OFF，使用PreExecute功能时选择ON，否则选择OFF。

**PostExecute**：选择ON或OFF，默认为OFF，使用PostExecute功能时选择ON，否则选择OFF。

**LogFile**：填入log文件的路径和文件名，默认为“report/hidigitallink_log”。

## 参数解释

**参数SpecType**：可选两种扫描方式RelativeMode或AbsoluteMode，RelativeMode是以spec为中心点向四周扫描，AbsoluteMode是以等分的形式去扫描。
<font color = Red>RelativeMode模式下，参数UL代表扫描系数的最大值，参数LL代表扫描系数的最小值，每个扫描点的实际值为Spec变量初始值X系数当前值。</font>
<font color = Red>AbsoluteMode模式下，参数UL代表扫描的当前Spec变量的最大值，参数LL代表扫的当前Specb变量的最小值，中间的扫描点实际值由最大最小值结合point数量均等分计算得出。</font>

**参数ResultType**：
ResultType=ALL：输出primary pattern名字 + shmoo结果；
ResultType=PerLabelRow: 输出每一条pattern名字 + shmoo结果；
ResultType=PerLabel：在输出ALL的基础上，输出每一个port名字 + 对应的一条pattern名字 + 对应的一个shmoo结果。

**参数Vclamp_EN**：Vclamp_EN用于在Shmoo扫描过程中保护电路，参数为ON时保护生效，系统内部会检查当前所扫spec基于扫描之前初始值的变化，如果小于初始值的0.5倍(含0.5)或者大于初始值的1.5倍(含1.5)系统会报错停止Shmoo扫描，<font color = Red>非特殊情况，使用时请开启Vclamp_EN</font>。

## 注意事项

**参数X 和参数Y**：用户在填入spec name时，需确保在level spec或Timing spec中有，否则在执行测试的时候候会出现spec找不到的问题, 并且如果填入的参数不是Vcoef或Tcoef则需要写成LEV.specname或TIM.specname(例如:LEV.DVDD1V8)这种形式，以便让系统判断所扫描的参数属于level还是Timing。


**对指定port扫Shmoo:**
<font color = blue>为了实现在某些port固定频率时对指定的其他port扫各个频率</font>，我们在1.8.4版本之后给SHM增加了可以指定port的功能，如果对X或Y轴的Spec(Spec一般指Tcoef)指定了port，则扫Shmoo的时候只对这些port对应的pin改变频率，而其他pin的频率在Shmoo的每个点为固定初始值，这样用户就不用修改tming EQN 中的定义，以此来达到简化调试的目的。
SHM参数格式如下:
在Spec名称后封号分隔定义port，要求port必须在向量中存在，多个port以逗号分隔

对指定port扫Shmoo时，如果具有多个dirve沿的pin未扫Shmoo，可能出现drive沿不在一个周期内的情况:

例如：
初始周期为10ns，上图所示的JTAG_TDI的d1、d2、d3、d4计算结分别为0、2.5、5、7.5
当扫Shmoo Tcoef变为0.5时，Period变为5，而JTAG_TDI并不扫Shmoo，它的drive沿的位置依然是0、2.5、5、7.5，由于周期变小为5ns，d4溢出至下一个周期

如果pin的所有drive沿不在一个周期内时，Smartest会报上图console的message

<font color = blue>建议：
1.message不属于Error和Warning，因此用户调试时无需太过关注
2.Smartest报message，可以适当修改Timing使其扫Shmoo时不报message
3.新定义spec扫正常Shmoo，不使用指定port的功能</font>

**参数Vclamp_EN**: Vclamp_EN关闭时需要注意拉偏电压，防止电压过大将芯片击穿。

